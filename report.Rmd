---
title: "tables"
author: "Jaylin Lowe"
date: "6/6/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(wesanderson)
library(gridExtra)
```
# Introduction

# Methods

# Results 

\begin{tabular}{cccccccc}
\hline
Variable & Minimum & 1st Quartile& Median & Mean & 3rd Quartile & Max & SD \\ 
\hline
Price & 25.00 & 800.00 & 1005.00 & 1138.00 & 1350.00 & 4845.00 & 509.53 \\
Log(Price) & 3.23 & 6.69 &6. 92 & 6.95 & 7.21 & 8.49 & 0.42 \\
Bedrooms & 0.00 & 1.00 & 2.00 & 1.72 & 2.00 & 5.00 & 0.75 \\
Bathrooms & 0.00 & 1.00 & 1.00 & 1.42 & 2.00 & 4.50 & 0.55 \\
Square Footage & 25.00 & 724.80 & 900.00 & 913.10 & 1063.20 & 5600.00 & 296.02 \\
Median Income & 44097.00 & 55462.00 & 59995.00 & 61738.00 & 70315.00 & 83242.00 & 9275.55\\
Population Density & 1.01 & 88.05 & 156.24 & 186.24 & 241.38 & 1018.25 & 166.54 \\
Tax Rate & 0.32 & 0.77 & 1.02 & 1.17 & 1.61 & 2.31 & 0.53 \\ 
\hline
\end{tabular}

```{r, echo = FALSE, fig.align = 'center', fig.cap = "Boxplots for Level 1 Dummy Variables by Rent Price", fig.height = 4, fig.width = 6}
data2$pets_allowed2 <- factor(data2$pets_allowed, levels = c(0,1), labels = c("No", "Yes"))
data2$smoking_allowed2 <- factor(data2$smoking_allowed, levels = c(0,1), labels = c("No", "Yes"))
data2$wheelchair_access2 <- factor(data2$wheelchair_access, levels = c(0,1), labels = c("No", "Yes"))
data2$comes_furnished2 <- factor(data2$comes_furnished, levels = c(0,1), labels = c("No", "Yes"))

# grid of boxplots of price by respective level one dummy variable
p1 <- ggplot(data2) + 
  geom_boxplot(mapping = aes(y = price, x = pets_allowed2, fill = pets_allowed2)) + 
  labs(x = "Pets Allowed", fill = "Pets Allowed?") +
  scale_fill_manual(values = wes_palette("Moonrise1", n = 2)) +
  scale_y_continuous(breaks = seq(0, 5000, 500))

p2 <- ggplot(data2) + 
  geom_boxplot(mapping = aes(y = price, x = smoking_allowed2, fill = smoking_allowed2)) + 
  labs(x = "Smoking Allowed", fill = "Smoking Allowed?") +
  scale_fill_manual(values = wes_palette("Moonrise1", n = 2)) +
  scale_y_continuous(breaks = seq(0, 5000, 500))

p3 <- ggplot(data2) + 
  geom_boxplot(mapping = aes(y = price, x = wheelchair_access2, fill = wheelchair_access2)) + 
  labs(x = "Wheelchair Access", fill = "Wheelchair Access?") +
  scale_fill_manual(values = wes_palette("Moonrise1", n = 2)) +
  scale_y_continuous(breaks = seq(0, 5000, 500))

p4 <- ggplot(data2) + 
  geom_boxplot(mapping = aes(y = price, x = comes_furnished2, fill = comes_furnished2)) + 
  labs(x = "Comes Furnished", fill = "Comes Furnished?") +
  scale_fill_manual(values = wes_palette("Moonrise1", n = 2))  +
  scale_y_continuous(breaks = seq(0, 5000, 500))

grid.arrange(p1, p2, p3, p4, ncol = 2)
```

```{r, echo = FALSE, fig.align = 'center', fig.cap = "Median Rent Price by State"}
data <- read_csv("housingSubset.csv")
data2 <- data %>%
  filter(price > 5) %>%
  filter(state != "dc") %>%
  mutate(pets_allowed = ifelse(cats_allowed == 1 & dogs_allowed == 1, 1, 0))

data2 %>%
  group_by(`State Name`) %>%
  summarize(MedianPrice = median(price)) %>%
  ggplot() + geom_bar(aes(x = reorder(`State Name`, MedianPrice), y = MedianPrice), stat = "identity", fill = "cadetblue", alpha = 0.8) + 
  coord_flip() + 
  scale_y_continuous(breaks = seq(0, 2000, 200)) +
  labs(y = "Median Price", x = "State", title = "Median Rent Price By State ") + theme(axis.text.y = element_text(size = 7))
```

Level 1: $E(\log(\text{Price})_{i,j}) = a_i + \beta_0\text{scale(sqfeet)}_{i,j} + \beta_1\text{beds}_{i,j} + \beta_2\text{baths}_{i,j} + \beta_3\text{petsAllowed}_{i,j} + \beta_4\text{smokingAllowed} + \epsilon_{i,j}$ \newline
Level 2: $a_i = \alpha_0 + \alpha_1\text{scale(MedianIncome)}_{i} + \alpha_2\text{Governor}_i + \alpha_3\text{PopDensity}_i + \alpha_4\text{TaxRate}_i + u_i$ \newline
where $\epsilon \sim N(0, \sigma^2)$ and $u_i \sim N(0, {\sigma_b}^2)$

\begin{tabular}{cccc}
\hline
Parameter & Estimate & Standard Error & T Value \\ 
\hline
$\alpha_0$ & 7.152 & 0.068 & 104.425 \\
$\alpha_1$ & 0.164 & 0.023 & 7.099 \\
$\alpha_2$ & -0.113 & 0.044 & -2.571 \\
$\alpha_3$ & 0.0002 & 0.0001 & 1.882 \\ 
$\alpha_4$ & -0.098 & 0.046 & -2.113 \\
$\beta_0$ & 0.202 & 0.012 & 18.703 \\
$\beta_1$ & -0.126 & 0.016 & -9.246\\
$\beta_2$ & 0.071 & 0.016 & 4.312 \\
$\beta_3$ & 0.075 & 0.014 & 5.231 \\
$\beta_4$ & -0.033 & 0.016 & -2.107 \\
\hline
\end{tabular}

# Discussion
